<HTML>
<HEAD>
<TITLE>Modelica.Fluid.Valves</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Components for the regulation and control of fluid flow&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal}
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Valves<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica.Fluid.Valves"></A><A HREF="Modelica_Fluid.html#Modelica.Fluid"
>Modelica.Fluid</A>.Valves</H2>
<B>Components for the regulation and control of fluid flow</B>
<P>
<P><H3>Information</H3></P>
<PRE></pre>

<pre></PRE><P>
Extends from <A HREF="Modelica_Icons_VariantsPackage.html#Modelica.Icons.VariantsPackage"
>Modelica.Icons.VariantsPackage</A> (Icon for package containing variants).
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleS.png" ALT="Modelica.Fluid.Valves.ValveIncompressible" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves.ValveIncompressible"
>ValveIncompressible</A>
</TD><TD>Valve for (almost) incompressible fluids</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleS.png" ALT="Modelica.Fluid.Valves.ValveVaporizing" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves.ValveVaporizing"
>ValveVaporizing</A>
</TD><TD>Valve for possibly vaporizing (almost) incompressible fluids, accounts for choked flow conditions</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleS.png" ALT="Modelica.Fluid.Valves.ValveCompressible" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves.ValveCompressible"
>ValveCompressible</A>
</TD><TD>Valve for compressible fluids, accounts for choked flow conditions</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.ValveLinearS.png" ALT="Modelica.Fluid.Valves.ValveLinear" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves.ValveLinear"
>ValveLinear</A>
</TD><TD>Valve for water/steam flows with linear pressure drop</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.ValveDiscreteS.png" ALT="Modelica.Fluid.Valves.ValveDiscrete" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves.ValveDiscrete"
>ValveDiscrete</A>
</TD><TD>Valve for water/steam flows with linear pressure drop</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Valves.BaseClassesS.png" ALT="Modelica.Fluid.Valves.BaseClasses" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses"
>BaseClasses</A>
</TD><TD>Base classes used in the Valves package (only of interest to build new component models)</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveIncompressible<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleI.png" ALT="Modelica.Fluid.Valves.ValveIncompressible" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Valves.ValveIncompressible"></A><A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves"
>Modelica.Fluid.Valves</A>.ValveIncompressible</H2>
<B>Valve for (almost) incompressible fluids</B><p>
<IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleD.png" ALT="Modelica.Fluid.Valves.ValveIncompressible">
<P><H3>Information</H3></P>
<PRE></pre>
<p>
Valve model according to the IEC 534/ISA S.75 standards for valve sizing, incompressible fluids.<
/p>

<p>
The parameters of this model are explained in detail in
<A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>PartialValve</a>
(the base model for valves).
</p>

<p>
This model assumes that the fluid has a low compressibility, which is always the case for liquids.
It can also be used with gases, provided that the pressure drop is lower than 0.2 times the absolute pressure at the inlet, so that the fluid density does not change much inside the valve.</p>

<p>
If <code>checkValve</code> is false, the valve supports reverse flow, with a symmetric flow characteric curve. Otherwise, reverse flow is stopped (check valve behaviour).
</p>

<p>
The treatment of parameters <b>Kv</b> and <b>Cv</b> is
explained in detail in the
<A HREF="Modelica_Fluid_UsersGuide_ComponentDefinition.html#Modelica.Fluid.UsersGuide.ComponentDefinition.ValveCharacteristics"
>User's Guide</a>.
</p>

<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A> (Base model for valves).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD colspan="2">replaceable function valveCharacteristic</TD><TD><A HREF="Modelica_Fluid_Valves_BaseClasses_ValveCharacteristics.html#Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.linear"
>linear</A></TD><TD>Inherent flow characteristic</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>CvTypes</A></TD><TD>CvData</TD><TD>Modelica.Fluid.Types.CvTypes...</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Density</A></TD><TD>rho_nominal</TD><TD>Medium.density_pTX(Medium.p_...</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>opening_nominal</TD><TD>1</TD><TD>Nominal opening</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Filtered opening</TD></TR>
<TR><TD>Boolean</TD><TD>filteredOpening</TD><TD>false</TD><TD>= true, if opening is filtered with a 2nd order CriticalDamping filter</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>riseTime</TD><TD>1</TD><TD>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</TD></TR>
<TR><TD>Real</TD><TD>leakageOpening</TD><TD>1e-3</TD><TD>The opening signal is limited by leakageOpening (to improve the numerics)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>checkValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_start</TD><TD>dp_nominal</TD><TD>Guess value of dp = port_a.p - port_b.p [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_start</TD><TD>m_flow_nominal</TD><TD>Guess value of m_flow = port_a.m_flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>system.m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_small</TD><TD>system.dp_small</TD><TD>Regularisation of zero flow [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>true</TD><TD>= true, if temperatures at port_a and port_b are computed</TD></TR>
<TR><TD>Boolean</TD><TD>show_V_flow</TD><TD>true</TD><TD>= true, if volume flow rate at inflowing port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD>input <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>opening</TD><TD>Valve position in the range 0..1</TD></TR>
<TR><TD>output <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>opening_filtered</TD><TD>Filtered valve position in the range 0..1</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveIncompressible <font color="darkgreen">&quot;Valve for (almost) incompressible fluids&quot;</font>
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A>;
<font color="blue">import </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>Modelica.Fluid.Types.CvTypes</A>;
<font color="blue">protected </font>
  Real relativeFlowCoefficient;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
      m_flow_nominal =<font color="red"> valveCharacteristic</font>(opening_nominal)*Av*<font color="red">sqrt</font>(rho_nominal)*<font color="red">Utilities.regRoot</font>(dp_nominal, dp_small) <font color="darkgreen">
      &quot;Determination of Av by the operating point&quot;</font>;
  <font color="blue">end if</font>;

<font color="blue">equation </font>
  <font color="darkgreen">// m_flow = valveCharacteristic(opening)*Av*sqrt(d)*sqrt(dp);</font>

  relativeFlowCoefficient =<font color="red"> valveCharacteristic</font>(opening_actual);
  <font color="blue">if </font>checkValve<font color="blue"> then</font>
    m_flow = relativeFlowCoefficient*Av*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
               <font color="red">Modelica.Fluid.Utilities.regRoot2</font>(dp,dp_small,1.0,0.0,use_yd0=true,yd0=0.0);
    <font color="darkgreen">/* In Modelica 3.1 (Disadvantage: Unnecessary event at dp=0, and smooth=0, instead of smooth=2)
    m_flow = valveCharacteristic(opening)*Av*sqrt(Medium.density(state_a))*
                  (if dp&gt;=0 then Utilities.regRoot(dp, dp_small) else 0);
    */</font>
  <font color="blue">elseif </font><font color="blue">not </font>allowFlowReversal<font color="blue"> then</font>
    m_flow = relativeFlowCoefficient*Av*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
                  <font color="red">Utilities.regRoot</font>(dp, dp_small);
  <font color="blue">else</font>
    m_flow = relativeFlowCoefficient*Av*
                <font color="red">Modelica.Fluid.Utilities.regRoot2</font>(dp,dp_small,<font color="red">Medium.density</font>(state_a),<font color="red">Medium.density</font>(state_b));

    <font color="darkgreen">/* In Modelica 3.1 (Disadvantage: Unnecessary event at dp=0, and smooth=0, instead of smooth=2)
    m_flow = smooth(0, Utilities.regRoot(dp, dp_small)*(if dp&gt;=0 then sqrt(Medium.density(state_a)) else sqrt(Medium.density(state_b))));
    */</font>
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ValveIncompressible;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveVaporizing<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleI.png" ALT="Modelica.Fluid.Valves.ValveVaporizing" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Valves.ValveVaporizing"></A><A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves"
>Modelica.Fluid.Valves</A>.ValveVaporizing</H2>
<B>Valve for possibly vaporizing (almost) incompressible fluids, accounts for choked flow conditions</B><p>
<IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleD.png" ALT="Modelica.Fluid.Valves.ValveVaporizing">
<P><H3>Information</H3></P>
<PRE></pre>
<p>Valve model according to the IEC 534/ISA S.75 standards for valve sizing, incompressible fluid at the inlet, and possibly two-phase fluid at the outlet, including choked flow conditions.</p>

<p>
The parameters of this model are explained in detail in
<A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>PartialValve</a>
(the base model for valves).
</p>

<p>The model operating range includes choked flow operation, which takes place for low outlet pressures due to flashing in the vena contracta; otherwise, non-choking conditions are assumed.
<p>This model requires a two-phase medium model, to describe the liquid and (possible) two-phase conditions.
<p>The default liquid pressure recovery coefficient <code>Fl</code> is constant and given by the parameter <code>Fl_nominal</code>. The relative change (per unit) of the recovery coefficient can be specified as a given function of the valve opening by replacing the <code>FlCharacteristic</code> function.
<p>If <code>checkValve</code> is false, the valve supports reverse flow, with a symmetric flow characteric curve. Otherwise, reverse flow is stopped (check valve behaviour).</p>

<p>
The treatment of parameters <b>Kv</b> and <b>Cv</b> is
explained in detail in the
<A HREF="Modelica_Fluid_UsersGuide_ComponentDefinition.html#Modelica.Fluid.UsersGuide.ComponentDefinition.ValveCharacteristics"
>User's Guide</a>.
</p>

<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A> (Base model for valves).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD colspan="2">replaceable function valveCharacteristic</TD><TD><A HREF="Modelica_Fluid_Valves_BaseClasses_ValveCharacteristics.html#Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.linear"
>linear</A></TD><TD>Inherent flow characteristic</TD></TR>
<TR><TD>Real</TD><TD>Fl_nominal</TD><TD>0.9</TD><TD>Liquid pressure recovery factor</TD></TR>
<TR><TD colspan="2">replaceable function FlCharacteristic</TD><TD>Modelica.Fluid.Valves.BaseCl...</TD><TD>Pressure recovery characteristic</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>CvTypes</A></TD><TD>CvData</TD><TD>Modelica.Fluid.Types.CvTypes...</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Density</A></TD><TD>rho_nominal</TD><TD>Medium.density_pTX(Medium.p_...</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>opening_nominal</TD><TD>1</TD><TD>Nominal opening</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Filtered opening</TD></TR>
<TR><TD>Boolean</TD><TD>filteredOpening</TD><TD>false</TD><TD>= true, if opening is filtered with a 2nd order CriticalDamping filter</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>riseTime</TD><TD>1</TD><TD>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</TD></TR>
<TR><TD>Real</TD><TD>leakageOpening</TD><TD>1e-3</TD><TD>The opening signal is limited by leakageOpening (to improve the numerics)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>checkValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_start</TD><TD>dp_nominal</TD><TD>Guess value of dp = port_a.p - port_b.p [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_start</TD><TD>m_flow_nominal</TD><TD>Guess value of m_flow = port_a.m_flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>system.m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_small</TD><TD>system.dp_small</TD><TD>Regularisation of zero flow [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>true</TD><TD>= true, if temperatures at port_a and port_b are computed</TD></TR>
<TR><TD>Boolean</TD><TD>show_V_flow</TD><TD>true</TD><TD>= true, if volume flow rate at inflowing port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD>input <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>opening</TD><TD>Valve position in the range 0..1</TD></TR>
<TR><TD>output <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>opening_filtered</TD><TD>Filtered valve position in the range 0..1</TD></TR>
<TR><TD colspan="2">replaceable function FlCharacteristic</TD><TD>Pressure recovery characteristic</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveVaporizing <font color="darkgreen">
  &quot;Valve for possibly vaporizing (almost) incompressible fluids, accounts for choked flow conditions&quot;</font>
  <font color="blue">import </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>Modelica.Fluid.Types.CvTypes</A>;
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A>(
    <font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium =
        <A HREF="Modelica_Media_Water_WaterIF97_ph.html#Modelica.Media.Water.WaterIF97_ph"
>Modelica.Media.Water.WaterIF97_ph</A>                                    <font color="blue">constrainedby </font>
      Modelica.Media.Interfaces.PartialTwoPhaseMedium);
  <font color="blue">parameter </font>Real Fl_nominal=0.9 <font color="darkgreen">&quot;Liquid pressure recovery factor&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> FlCharacteristic =
      <A HREF="Modelica_Fluid_Valves_BaseClasses_ValveCharacteristics.html#Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.one"
>Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.one</A>
    <font color="blue">constrainedby </font>
    Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.baseFun <font color="darkgreen">
    &quot;Pressure recovery characteristic&quot;</font>;
  Real Ff <font color="darkgreen">&quot;Ff coefficient (see IEC/ISA standard)&quot;</font>;
  Real Fl <font color="darkgreen">&quot;Pressure recovery coefficient Fl (see IEC/ISA standard)&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dpEff <font color="darkgreen">&quot;Effective pressure drop&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T_in <font color="darkgreen">&quot;Inlet temperature&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p_sat <font color="darkgreen">&quot;Saturation pressure&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p_in <font color="darkgreen">&quot;Inlet pressure&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p_out <font color="darkgreen">&quot;Outlet pressure&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="red">assert</font>(<font color="blue">not </font>CvData == CvTypes.OpPoint, &quot;OpPoint option not supported for vaporizing valve&quot;);
<font color="blue">equation </font>
  p_in = port_a.p;
  p_out = port_b.p;
  T_in =<font color="red"> Medium.temperature</font>(state_a);
  p_sat =<font color="red"> Medium.saturationPressure</font>(T_in);
  Ff = 0.96 - 0.28*<font color="red">sqrt</font>(p_sat/Medium.fluidConstants[1].criticalPressure);
  Fl = Fl_nominal*<font color="red">FlCharacteristic</font>(opening_actual);
  dpEff = <font color="blue">if </font>p_out &lt; (1 - Fl^2)*p_in + Ff*Fl^2*p_sat<font color="blue"> then </font>
            Fl^2*(p_in - Ff*p_sat)<font color="blue"> else </font>dp <font color="darkgreen">
    &quot;Effective pressure drop, accounting for possible choked conditions&quot;</font>;
  <font color="darkgreen">// m_flow = valveCharacteristic(opening)*Av*sqrt(d)*sqrt(dpEff);</font>
  <font color="blue">if </font>checkValve<font color="blue"> then</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
               <font color="red">Modelica.Fluid.Utilities.regRoot2</font>(dpEff,dp_small,1.0,0.0,use_yd0=true,yd0=0.0);
   <font color="darkgreen">/* In Modelica 3.1 (Disadvantage: Unnecessary event at dpEff=0, and smooth=0, instead of smooth=2)
    m_flow = valveCharacteristic(opening)*Av*sqrt(Medium.density(state_a))*
                  (if dpEff&gt;=0 then Utilities.regRoot(dpEff, dp_small) else 0);
   */</font>
  <font color="blue">elseif </font><font color="blue">not </font>allowFlowReversal<font color="blue"> then</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
                  <font color="red">Utilities.regRoot</font>(dpEff, dp_small);
  <font color="blue">else</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*
                <font color="red">Modelica.Fluid.Utilities.regRoot2</font>(dpEff,dp_small,<font color="red">Medium.density</font>(state_a),<font color="red">Medium.density</font>(state_b));
    <font color="darkgreen">/* In Modelica 3.1 (Disadvantage: Unnecessary event at dp=0, and smooth=0, instead of smooth=2)
     m_flow = valveCharacteristic(opening)*Av*
      smooth(0, Utilities.regRoot(dpEff, dp_small)*(if dpEff&gt;=0 then sqrt(Medium.density(state_a)) else sqrt(Medium.density(state_b))));
   */</font>
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ValveVaporizing;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveCompressible<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleI.png" ALT="Modelica.Fluid.Valves.ValveCompressible" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Valves.ValveCompressible"></A><A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves"
>Modelica.Fluid.Valves</A>.ValveCompressible</H2>
<B>Valve for compressible fluids, accounts for choked flow conditions</B><p>
<IMG SRC="Modelica.Fluid.Valves.ValveIncompressibleD.png" ALT="Modelica.Fluid.Valves.ValveCompressible">
<P><H3>Information</H3></P>
<PRE></pre>
<p>Valve model according to the IEC 534/ISA S.75 standards for valve sizing, compressible fluid, no phase change, also covering choked-flow conditions.</p>

<p>
The parameters of this model are explained in detail in
<A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>PartialValve</a>
(the base model for valves).
</p>

<p>This model can be used with gases and vapours, with arbitrary pressure ratio between inlet and outlet.</p>

<p>The product Fk*xt is given by the parameter <code>Fxt_full</code>, and is assumed constant by default. The relative change (per unit) of the xt coefficient with the valve opening can be specified by replacing the <code>xtCharacteristic</code> function.
<p>If <code>checkValve</code> is false, the valve supports reverse flow, with a symmetric flow characteric curve. Otherwise, reverse flow is stopped (check valve behaviour).</p>

<p>
The treatment of parameters <b>Kv</b> and <b>Cv</b> is
explained in detail in the
<A HREF="Modelica_Fluid_UsersGuide_ComponentDefinition.html#Modelica.Fluid.UsersGuide.ComponentDefinition.ValveCharacteristics"
>User's Guide</a>.
</p>

<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A> (Base model for valves).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD colspan="2">replaceable function valveCharacteristic</TD><TD><A HREF="Modelica_Fluid_Valves_BaseClasses_ValveCharacteristics.html#Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.linear"
>linear</A></TD><TD>Inherent flow characteristic</TD></TR>
<TR><TD>Real</TD><TD>Fxt_full</TD><TD>0.5</TD><TD>Fk*xt critical ratio at full opening</TD></TR>
<TR><TD colspan="2">replaceable function xtCharacteristic</TD><TD>Modelica.Fluid.Valves.BaseCl...</TD><TD>Critical ratio characteristic</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>CvTypes</A></TD><TD>CvData</TD><TD>Modelica.Fluid.Types.CvTypes...</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Density</A></TD><TD>rho_nominal</TD><TD>Medium.density_pTX(Medium.p_...</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>opening_nominal</TD><TD>1</TD><TD>Nominal opening</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p_nominal</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Filtered opening</TD></TR>
<TR><TD>Boolean</TD><TD>filteredOpening</TD><TD>false</TD><TD>= true, if opening is filtered with a 2nd order CriticalDamping filter</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>riseTime</TD><TD>1</TD><TD>Rise time of the filter (time to reach 99.6 % of an opening step) [s]</TD></TR>
<TR><TD>Real</TD><TD>leakageOpening</TD><TD>1e-3</TD><TD>The opening signal is limited by leakageOpening (to improve the numerics)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR><TD>Boolean</TD><TD>checkValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_start</TD><TD>dp_nominal</TD><TD>Guess value of dp = port_a.p - port_b.p [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_start</TD><TD>m_flow_nominal</TD><TD>Guess value of m_flow = port_a.m_flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>system.m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_small</TD><TD>system.dp_small</TD><TD>Regularisation of zero flow [Pa]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>true</TD><TD>= true, if temperatures at port_a and port_b are computed</TD></TR>
<TR><TD>Boolean</TD><TD>show_V_flow</TD><TD>true</TD><TD>= true, if volume flow rate at inflowing port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD>input <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>opening</TD><TD>Valve position in the range 0..1</TD></TR>
<TR><TD>output <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>opening_filtered</TD><TD>Filtered valve position in the range 0..1</TD></TR>
<TR><TD colspan="2">replaceable function xtCharacteristic</TD><TD>Critical ratio characteristic</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveCompressible <font color="darkgreen">
  &quot;Valve for compressible fluids, accounts for choked flow conditions&quot;</font>
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Valves_BaseClasses.html#Modelica.Fluid.Valves.BaseClasses.PartialValve"
>BaseClasses.PartialValve</A>;
  <font color="blue">import </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.CvTypes"
>Modelica.Fluid.Types.CvTypes</A>;
  <font color="blue">parameter </font><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p_nominal <font color="darkgreen">&quot;Nominal inlet pressure&quot;</font>;
  <font color="blue">parameter </font>Real Fxt_full=0.5 <font color="darkgreen">&quot;Fk*xt critical ratio at full opening&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> xtCharacteristic =
      <A HREF="Modelica_Fluid_Valves_BaseClasses_ValveCharacteristics.html#Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.one"
>Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.one</A>
    <font color="blue">constrainedby </font>
    Modelica.Fluid.Valves.BaseClasses.ValveCharacteristics.baseFun <font color="darkgreen">
    &quot;Critical ratio characteristic&quot;</font>;
  Real Fxt;
  Real x <font color="darkgreen">&quot;Pressure drop ratio&quot;</font>;
  Real xs <font color="darkgreen">&quot;Saturated pressure drop ratio&quot;</font>;
  Real Y <font color="darkgreen">&quot;Compressibility factor&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Inlet pressure&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real Fxt_nominal(fixed=false) <font color="darkgreen">&quot;Nominal Fxt&quot;</font>;
  <font color="blue">parameter </font>Real x_nominal(fixed=false) <font color="darkgreen">&quot;Nominal pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real xs_nominal(fixed=false) <font color="darkgreen">
    &quot;Nominal saturated pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real Y_nominal(fixed=false) <font color="darkgreen">&quot;Nominal compressibility factor&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
    <font color="darkgreen">// Determination of Av by the nominal operating point conditions</font>
    Fxt_nominal = Fxt_full*<font color="red">xtCharacteristic</font>(opening_nominal);
    x_nominal = dp_nominal/p_nominal;
    xs_nominal =<font color="red"> smooth</font>(0, <font color="blue">if </font>x_nominal &gt; Fxt_nominal<font color="blue"> then </font>Fxt_nominal<font color="blue"> else </font>x_nominal);
    Y_nominal = 1 -<font color="red"> abs</font>(xs_nominal)/(3*Fxt_nominal);
    m_flow_nominal =<font color="red"> valveCharacteristic</font>(opening_nominal)*Av*Y_nominal*<font color="red">sqrt</font>(rho_nominal)*<font color="red">Utilities.regRoot</font>(p_nominal*xs_nominal, dp_small);
  <font color="blue">else</font>
    <font color="darkgreen">// Dummy values</font>
    Fxt_nominal = 0;
    x_nominal = 0;
    xs_nominal = 0;
    Y_nominal = 0;
  <font color="blue">end if</font>;

<font color="blue">equation </font>
  p =<font color="red"> noEvent</font>(<font color="blue">if </font>dp&gt;=0<font color="blue"> then </font>port_a.p<font color="blue"> else </font>port_b.p);
  Fxt = Fxt_full*<font color="red">xtCharacteristic</font>(opening_actual);
  x = dp/p;
  xs =<font color="red"> smooth</font>(0, <font color="blue">if </font>x &lt; -Fxt<font color="blue"> then </font>-Fxt<font color="blue"> else </font><font color="blue">if </font>x &gt; Fxt<font color="blue"> then </font>Fxt<font color="blue"> else </font>x);
  Y = 1 -<font color="red"> abs</font>(xs)/(3*Fxt);
  <font color="darkgreen">// m_flow = valveCharacteristic(opening)*Av*Y*sqrt(d)*sqrt(p*xs);</font>
  <font color="blue">if </font>checkValve<font color="blue"> then</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*Y*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
      (<font color="blue">if </font>xs&gt;=0<font color="blue"> then </font><font color="red">Utilities.regRoot</font>(p*xs, dp_small)<font color="blue"> else </font>0);
  <font color="blue">elseif </font><font color="blue">not </font>allowFlowReversal<font color="blue"> then</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*<font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))*
                  <font color="red">Utilities.regRoot</font>(p*xs, dp_small);
  <font color="blue">else</font>
    m_flow =<font color="red"> valveCharacteristic</font>(opening_actual)*Av*Y*
      <font color="red">smooth</font>(0,<font color="red"> Utilities.regRoot</font>(p*xs, dp_small)*(<font color="blue">if </font>xs&gt;=0<font color="blue"> then </font><font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_a))<font color="blue"> else </font><font color="red">sqrt</font>(<font color="red">Medium.density</font>(state_b))));
<font color="darkgreen">/*
    m_flow = valveCharacteristic(opening)*Av*Y*
                  Modelica.Fluid.Utilities.regRoot2(p*xs, dp_small, Medium.density(state_a), Medium.density(state_b));
*/</font>
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ValveCompressible;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveLinear<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Valves.ValveLinearI.png" ALT="Modelica.Fluid.Valves.ValveLinear" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Valves.ValveLinear"></A><A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves"
>Modelica.Fluid.Valves</A>.ValveLinear</H2>
<B>Valve for water/steam flows with linear pressure drop</B><p>
<IMG SRC="Modelica.Fluid.Valves.ValveLinearD.png" ALT="Modelica.Fluid.Valves.ValveLinear">
<P><H3>Information</H3></P>
<PRE></pre>
<p>This very simple model provides a pressure drop which is proportional to the flowrate and to the <code>opening</code> input, without computing any fluid property. It can be used for testing purposes, when
a simple model of a variable pressure loss is needed.</p>
<p>A medium model must be nevertheless be specified, so that the fluid ports can be connected to other components using the same medium model.</p>
<p>The model is adiabatic (no heat losses to the ambient) and neglects changes in kinetic energy from the inlet to the outlet.</p>
<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>Modelica.Fluid.Interfaces.PartialTwoPortTransport</A> (Partial element transporting fluid between two ports without storage of mass or energy).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Nominal pressure drop at full opening [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate at full opening [kg/s]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_start</TD><TD>0.01*system.p_start</TD><TD>Guess value of dp = port_a.p - port_b.p [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_start</TD><TD>system.m_flow_start</TD><TD>Guess value of m_flow = port_a.m_flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>system.m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>true</TD><TD>= true, if temperatures at port_a and port_b are computed</TD></TR>
<TR><TD>Boolean</TD><TD>show_V_flow</TD><TD>true</TD><TD>= true, if volume flow rate at inflowing port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD>input <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>opening</TD><TD>=1: completely open, =0: completely closed</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveLinear <font color="darkgreen">
  &quot;Valve for water/steam flows with linear pressure drop&quot;</font>
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>Modelica.Fluid.Interfaces.PartialTwoPortTransport</A>;
  <font color="blue">parameter </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>SI.AbsolutePressure</A> dp_nominal <font color="darkgreen">
    &quot;Nominal pressure drop at full opening&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</A> m_flow_nominal <font color="darkgreen">
    &quot;Nominal mass flowrate at full opening&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.HydraulicConductance"
>Types.HydraulicConductance</A> k = m_flow_nominal/dp_nominal <font color="darkgreen">
    &quot;Hydraulic conductance at full opening&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> opening(min=0,max=1) <font color="darkgreen">
    &quot;=1: completely open, =0: completely closed&quot;</font>;</textblock>

<font color="blue">equation </font>
  m_flow = opening*k*dp;

  <font color="darkgreen">// Isenthalpic state transformation (no storage and no loss of energy)</font>
  port_a.h_outflow =<font color="red"> inStream</font>(port_b.h_outflow);
  port_b.h_outflow =<font color="red"> inStream</font>(port_a.h_outflow);

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ValveLinear;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveDiscrete<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Valves.ValveDiscreteI.png" ALT="Modelica.Fluid.Valves.ValveDiscrete" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Valves.ValveDiscrete"></A><A HREF="Modelica_Fluid_Valves.html#Modelica.Fluid.Valves"
>Modelica.Fluid.Valves</A>.ValveDiscrete</H2>
<B>Valve for water/steam flows with linear pressure drop</B><p>
<IMG SRC="Modelica.Fluid.Valves.ValveDiscreteD.png" ALT="Modelica.Fluid.Valves.ValveDiscrete">
<P><H3>Information</H3></P>
<PRE></pre>
<p>
This very simple model provides a (small) pressure drop which is proportional to the flowrate if the Boolean open signal is <b>true</b>. Otherwise, the mass flow rate is zero. If opening_min > 0, a small leakage mass flow rate occurs when open = <b>false</b>.
</p>
<p>This model can be used for simplified modelling of on-off valves, when it is not important to accurately describe the pressure loss when the valve is open. Although the medium model is not used to determine the pressure loss, it must be nevertheless be specified, so that the fluid ports can be connected to other components using the same medium model.</p>
<p>The model is adiabatic (no heat losses to the ambient) and neglects changes in kinetic energy from the inlet to the outlet.</p>
<p>
In a diagram animation, the valve is shown in "green", when
it is open.
</p>
<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>Modelica.Fluid.Interfaces.PartialTwoPortTransport</A> (Partial element transporting fluid between two ports without storage of mass or energy).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp_nominal</TD><TD>&nbsp;</TD><TD>Nominal pressure drop at full opening=1 [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_nominal</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate at full opening=1 [kg/s]</TD></TR>
<TR><TD>Real</TD><TD>opening_min</TD><TD>0</TD><TD>Remaining opening if closed, causing small leakage flow</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Advanced</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_start</TD><TD>0.01*system.p_start</TD><TD>Guess value of dp = port_a.p - port_b.p [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_start</TD><TD>system.m_flow_start</TD><TD>Guess value of m_flow = port_a.m_flow [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>system.m_flow_small</TD><TD>Small mass flow rate for regularization of zero flow [kg/s]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Diagnostics</TD></TR>
<TR><TD>Boolean</TD><TD>show_T</TD><TD>true</TD><TD>= true, if temperatures at port_a and port_b are computed</TD></TR>
<TR><TD>Boolean</TD><TD>show_V_flow</TD><TD>true</TD><TD>= true, if volume flow rate at inflowing port is computed</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD>input <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BooleanInput"
>BooleanInput</A></TD><TD>open</TD><TD>&nbsp;</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveDiscrete <font color="darkgreen">
  &quot;Valve for water/steam flows with linear pressure drop&quot;</font>
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPortTransport"
>Modelica.Fluid.Interfaces.PartialTwoPortTransport</A>;
  <font color="blue">parameter </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_nominal <font color="darkgreen">&quot;Nominal pressure drop at full opening=1&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</A> m_flow_nominal <font color="darkgreen">
    &quot;Nominal mass flowrate at full opening=1&quot;</font>;
  <font color="blue">final </font><font color="blue">parameter </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.HydraulicConductance"
>Types.HydraulicConductance</A> k = m_flow_nominal/dp_nominal <font color="darkgreen">
    &quot;Hydraulic conductance at full opening=1&quot;</font>;
<textblock type="annotcomp" expanded="false">  <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.BooleanInput"
>Modelica.Blocks.Interfaces.BooleanInput</A> open;</textblock>
  <font color="blue">parameter </font>Real opening_min(min=0)=0 <font color="darkgreen">
    &quot;Remaining opening if closed, causing small leakage flow&quot;</font>;
<font color="blue">equation </font>
  m_flow = <font color="blue">if </font>open<font color="blue"> then </font>1*k*dp<font color="blue"> else </font>opening_min*k*dp;

  <font color="darkgreen">// Isenthalpic state transformation (no storage and no loss of energy)</font>
  port_a.h_outflow =<font color="red"> inStream</font>(port_b.h_outflow);
  port_b.h_outflow =<font color="red"> inStream</font>(port_a.h_outflow);

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>ValveDiscrete;
</PRE>
<HR>
<address><a href="http://www.3ds.com/">Automatically generated</a> Fri Nov 12 16:31:17 2010.
</address></BODY>
</HTML>
