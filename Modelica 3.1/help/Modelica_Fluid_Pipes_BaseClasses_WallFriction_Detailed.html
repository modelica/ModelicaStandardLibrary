<HTML>
<HEAD>
<TITLE>Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Pipe wall friction in the whole regime (detailed characteristic)&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal}
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Detailed<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed"></A><A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction"
>Modelica.Fluid.Pipes.BaseClasses.WallFriction</A>.Detailed</H2>
<B>Pipe wall friction in the whole regime (detailed characteristic)</B>
<P>
<P><H3>Information</H3>
<PRE></pre>
<p>
This component defines the complete regime of wall friction.
The details are described in the
<A HREF="Modelica_Fluid_UsersGuide_ComponentDefinition.html#Modelica.Fluid.UsersGuide.ComponentDefinition.WallFriction"
>UsersGuide</a>.
The functional relationship of the friction loss factor &lambda; is
displayed in the next figure. Function massFlowRate_dp() defines the "red curve"
("Swamee and Jain"), where as function pressureLoss_m_flow() defines the
"blue curve" ("Colebrook-White"). The two functions are inverses from
each other and give slightly different results in the transition region
between Re = 1500 .. 4000, in order to get explicit equations without
solving a non-linear equation.
</p>

<img src="../Images/Fluid/Components/PipeFriction1.png">

<p>
Additionally to wall friction, this component properly implements static
head. With respect to the latter, two cases can be distinguished. In the case
shown next, the change of elevation with the path from a to b has the opposite
sign of the change of density.</p>

<img src="../Images/Fluid/Components/PipeFrictionStaticHead_case-a.PNG">

<p>
In the case illustrated second, the change of elevation with the path from a to
b has the same sign of the change of density.</p>

<img src="../Images/Fluid/Components/PipeFrictionStaticHead_case-b.PNG">


<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_PartialWallFriction.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.PartialWallFriction"
>PartialWallFriction</A> (Partial wall friction characteristic (base package of all wall friction characteristics)).
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpS.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp"
>massFlowRate_dp</A>
</TD><TD>Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpS.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow"
>pressureLoss_m_flow</A>
</TD><TD>Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpS.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp_staticHead" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp_staticHead"
>massFlowRate_dp_staticHead</A>
</TD><TD>Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction and static head</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpS.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow_staticHead" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow_staticHead"
>pressureLoss_m_flow_staticHead</A>
</TD><TD>Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction and static head</TD></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.InternalS.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.Internal" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed_Internal.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.Internal"
>Internal</A>
</TD><TD>Functions to calculate mass flow rate from friction pressure drop and vice versa</TD></TR>
<TR><TH COLSPAN="2">Inherited</TH></TR>
<TR><TD>use_mu=true</TD><TD>= true, if mu_a/mu_b are used in function, otherwise value is not used</TD></TR>
<TR><TD>use_roughness=true</TD><TD>= true, if roughness is used in function, otherwise value is not used</TD></TR>
<TR><TD>use_dp_small=true</TD><TD>= true, if dp_small is used in function, otherwise value is not used</TD></TR>
<TR><TD>use_m_flow_small=true</TD><TD>= true, if m_flow_small is used in function, otherwise value is not used</TD></TR>
<TR><TD>dp_is_zero=false</TD><TD>= true, if no wall friction is present, i.e., dp = 0 (function massFlowRate_dp() cannot be used)</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE massFlowRate_dp<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpI.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp"></A><A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed"
>Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed</A>.massFlowRate_dp</H2>
<B>Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction</B><p>
<P><H3>Information</H3>
<PRE></pre>

<pre></PRE>
Extends from <A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_PartialWallFriction.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.PartialWallFriction.massFlowRate_dp"
></A> (Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction).
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>&nbsp;</TD><TD>Pressure loss (dp = port_a.p - port_b.p) [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a</TD><TD>&nbsp;</TD><TD>Density at port_a [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_b</TD><TD>&nbsp;</TD><TD>Density at port_b [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_a</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_a (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_b</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_b (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>length</TD><TD>&nbsp;</TD><TD>Length of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Diameter"
>Diameter</A></TD><TD>diameter</TD><TD>&nbsp;</TD><TD>Inner (hydraulic) diameter of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>roughness</TD><TD>2.5e-5</TD><TD>Absolute roughness of pipe, with a default for a smooth steel pipe (dummy if use_roughness = false) [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_small</TD><TD>1</TD><TD>Turbulent flow if |dp| &gt;= dp_small (dummy if use_dp_small = false) [Pa]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow</TD><TD>Mass flow rate from port_a to port_b [kg/s]</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">redeclare </font><font color="blue">function</font> <font color="blue">extends </font>massFlowRate_dp <font color="darkgreen">
  &quot;Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction&quot;</font>
  <font color="blue">import </font><A HREF="Modelica_Math.html#Modelica.Math"
>Modelica.Math</A>;
<font color="blue">protected </font>
  <font color="blue">constant </font>Real pi = Modelica.Constants.pi;
  Real Delta = roughness/diameter <font color="darkgreen">&quot;Relative roughness&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1 = (745*<font color="red">Math.exp</font>(<font color="blue">if </font>Delta &lt;= 0.0065<font color="blue"> then </font>1<font color="blue"> else </font>0.0065/Delta))^0.97 <font color="darkgreen">
    &quot;Re leaving laminar curve&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2 = 4000 <font color="darkgreen">&quot;Re entering turbulent curve&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>SI.DynamicViscosity</A> mu <font color="darkgreen">&quot;Upstream viscosity&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>SI.Density</A> rho <font color="darkgreen">&quot;Upstream density&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re <font color="darkgreen">&quot;Reynolds number&quot;</font>;
  Real lambda2 <font color="darkgreen">&quot;Modified friction coefficient (= lambda*Re^2)&quot;</font>;

  <font color="blue">function</font> interpolateInRegion2
     <font color="blue">input </font>Real Re_turbulent;
     <font color="blue">input </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1;
     <font color="blue">input </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2;
     <font color="blue">input </font>Real Delta;
     <font color="blue">input </font>Real lambda2;
     <font color="blue">output </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re;
    <font color="darkgreen">// point lg(lambda2(Re1)) with derivative at lg(Re1)</font>
  <font color="blue">protected </font>
    Real x1=<font color="red">Math.log10</font>(64*Re1);
    Real y1=<font color="red">Math.log10</font>(Re1);
    Real yd1=1;

    <font color="darkgreen">// Point lg(lambda2(Re2)) with derivative at lg(Re2)</font>
    Real aux1=(0.5/<font color="red">Math.log</font>(10))*5.74*0.9;
    Real aux2=Delta/3.7 + 5.74/Re2^0.9;
    Real aux3=<font color="red">Math.log10</font>(aux2);
    Real L2=0.25*(Re2/aux3)^2;
    Real aux4=2.51/<font color="red">sqrt</font>(L2) + 0.27*Delta;
    Real aux5=-2*<font color="red">sqrt</font>(L2)*<font color="red">Math.log10</font>(aux4);
    Real x2=<font color="red">Math.log10</font>(L2);
    Real y2=<font color="red">Math.log10</font>(aux5);
    Real yd2=0.5 + (2.51/<font color="red">Math.log</font>(10))/(aux5*aux4);

    <font color="darkgreen">// Constants: Cubic polynomial between lg(Re1) and lg(Re2)</font>
    Real diff_x=x2 - x1;
    Real m=(y2 - y1)/diff_x;
    Real c2=(3*m - 2*yd1 - yd2)/diff_x;
    Real c3=(yd1 + yd2 - 2*m)/(diff_x*diff_x);
    Real lambda2_1=64*Re1;
    Real dx;
  <font color="blue">algorithm </font>
     dx := <font color="red">Math.log10</font>(lambda2/lambda2_1);
     Re := Re1*(lambda2/lambda2_1)^(1 + dx*(c2 + dx*c3));
  <font color="blue">end </font>interpolateInRegion2;

<font color="blue">algorithm </font>
  <font color="darkgreen">// Determine upstream density, upstream viscosity, and lambda2</font>
  rho     := <font color="blue">if </font>dp &gt;= 0<font color="blue"> then </font>rho_a<font color="blue"> else </font>rho_b;
  mu      := <font color="blue">if </font>dp &gt;= 0<font color="blue"> then </font>mu_a<font color="blue"> else </font>mu_b;
  lambda2 :=<font color="red"> abs</font>(dp)*2*diameter^3*rho/(length*mu*mu);

  <font color="darkgreen">// Determine Re under the assumption of laminar flow</font>
  Re := lambda2/64;

  <font color="darkgreen">// Modify Re, if turbulent flow</font>
  <font color="blue">if </font>Re &gt; Re1<font color="blue"> then</font>
     Re :=-2*<font color="red">sqrt</font>(lambda2)*<font color="red">Math.log10</font>(2.51/<font color="red">sqrt</font>(lambda2) + 0.27*Delta);
     <font color="blue">if </font>Re &lt; Re2<font color="blue"> then</font>
        Re :=<font color="red"> interpolateInRegion2</font>(Re, Re1, Re2, Delta, lambda2);
     <font color="blue">end if</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Determine mass flow rate</font>
  m_flow := (pi*diameter/4)*mu*(<font color="blue">if </font>dp &gt;= 0<font color="blue"> then </font>Re<font color="blue"> else </font>-Re);
<font color="blue">end </font>massFlowRate_dp;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE pressureLoss_m_flow<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpI.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow"></A><A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed"
>Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed</A>.pressureLoss_m_flow</H2>
<B>Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction</B><p>
<P><H3>Information</H3>
<PRE></pre>

<pre></PRE>
Extends from <A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_PartialWallFriction.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.PartialWallFriction.pressureLoss_m_flow"
></A> (Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction).
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow</TD><TD>&nbsp;</TD><TD>Mass flow rate from port_a to port_b [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a</TD><TD>&nbsp;</TD><TD>Density at port_a [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_b</TD><TD>&nbsp;</TD><TD>Density at port_b [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_a</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_a (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_b</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_b (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>length</TD><TD>&nbsp;</TD><TD>Length of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Diameter"
>Diameter</A></TD><TD>diameter</TD><TD>&nbsp;</TD><TD>Inner (hydraulic) diameter of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>roughness</TD><TD>2.5e-5</TD><TD>Absolute roughness of pipe, with a default for a smooth steel pipe (dummy if use_roughness = false) [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>0.01</TD><TD>Turbulent flow if |m_flow| &gt;= m_flow_small (dummy if use_m_flow_small = false) [kg/s]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>Pressure loss (dp = port_a.p - port_b.p) [Pa]</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">redeclare </font><font color="blue">function</font> <font color="blue">extends </font>pressureLoss_m_flow <font color="darkgreen">
  &quot;Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction&quot;</font>
  <font color="blue">import </font><A HREF="Modelica_Math.html#Modelica.Math"
>Modelica.Math</A>;
<font color="blue">protected </font>
  <font color="blue">constant </font>Real pi = Modelica.Constants.pi;
  Real Delta = roughness/diameter <font color="darkgreen">&quot;Relative roughness&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1 = 745*<font color="red">Math.exp</font>(<font color="blue">if </font>Delta &lt;= 0.0065<font color="blue"> then </font>1<font color="blue"> else </font>0.0065/Delta) <font color="darkgreen">
    &quot;Re leaving laminar curve&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2 = 4000 <font color="darkgreen">&quot;Re entering turbulent curve&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>SI.DynamicViscosity</A> mu <font color="darkgreen">&quot;Upstream viscosity&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>SI.Density</A> rho <font color="darkgreen">&quot;Upstream density&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re <font color="darkgreen">&quot;Reynolds number&quot;</font>;
  Real lambda2 <font color="darkgreen">&quot;Modified friction coefficient (= lambda*Re^2)&quot;</font>;

  <font color="blue">function</font> interpolateInRegion2
     <font color="blue">input </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re;
     <font color="blue">input </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1;
     <font color="blue">input </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2;
     <font color="blue">input </font>Real Delta;
     <font color="blue">output </font>Real lambda2;
    <font color="darkgreen">// point lg(lambda2(Re1)) with derivative at lg(Re1)</font>
  <font color="blue">protected </font>
    Real x1 = <font color="red">Math.log10</font>(Re1);
    Real y1 = <font color="red">Math.log10</font>(64*Re1);
    Real yd1=1;

    <font color="darkgreen">// Point lg(lambda2(Re2)) with derivative at lg(Re2)</font>
    Real aux1=(0.5/<font color="red">Math.log</font>(10))*5.74*0.9;
    Real aux2=Delta/3.7 + 5.74/Re2^0.9;
    Real aux3=<font color="red">Math.log10</font>(aux2);
    Real L2=0.25*(Re2/aux3)^2;
    Real aux4=2.51/<font color="red">sqrt</font>(L2) + 0.27*Delta;
    Real aux5=-2*<font color="red">sqrt</font>(L2)*<font color="red">Math.log10</font>(aux4);
    Real x2 =<font color="red">  Math.log10</font>(Re2);
    Real y2 =<font color="red">  Math.log10</font>(L2);
    Real yd2 = 2 + 4*aux1/(aux2*aux3*(Re2)^0.9);

    <font color="darkgreen">// Constants: Cubic polynomial between lg(Re1) and lg(Re2)</font>
    Real diff_x=x2 - x1;
    Real m=(y2 - y1)/diff_x;
    Real c2=(3*m - 2*yd1 - yd2)/diff_x;
    Real c3=(yd1 + yd2 - 2*m)/(diff_x*diff_x);
    Real dx;
  <font color="blue">algorithm </font>
     dx := <font color="red">Math.log10</font>(Re/Re1);
     lambda2 := 64*Re1*(Re/Re1)^(1 + dx*(c2 + dx*c3));
  <font color="blue">end </font>interpolateInRegion2;
<font color="blue">algorithm </font>
  <font color="darkgreen">// Determine upstream density and upstream viscosity</font>
  rho     :=<font color="blue">if </font>m_flow &gt;= 0<font color="blue"> then </font>rho_a<font color="blue"> else </font>rho_b;
  mu      :=<font color="blue">if </font>m_flow &gt;= 0<font color="blue"> then </font>mu_a<font color="blue"> else </font>mu_b;

  <font color="darkgreen">// Determine Re, lambda2 and pressure drop</font>
  Re :=(4/pi)*<font color="red">abs</font>(m_flow)/(diameter*mu);
  lambda2 := <font color="blue">if </font>Re &lt;= Re1<font color="blue"> then </font>64*Re<font color="blue"> else </font>
            (<font color="blue">if </font>Re &gt;= Re2<font color="blue"> then </font>0.25*(Re/<font color="red">Math.log10</font>(Delta/3.7 + 5.74/Re^0.9))^2<font color="blue"> else </font>
             <font color="red">interpolateInRegion2</font>(Re, Re1, Re2, Delta));
  dp :=length*mu*mu/(2*rho*diameter*diameter*diameter)*
       (<font color="blue">if </font>m_flow &gt;= 0<font color="blue"> then </font>lambda2<font color="blue"> else </font>-lambda2);
<font color="blue">end </font>pressureLoss_m_flow;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE massFlowRate_dp_staticHead<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpI.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp_staticHead" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dp_staticHead"></A><A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed"
>Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed</A>.massFlowRate_dp_staticHead</H2>
<B>Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction and static head</B><p>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>&nbsp;</TD><TD>Pressure loss (dp = port_a.p - port_b.p) [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a</TD><TD>&nbsp;</TD><TD>Density at port_a [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_b</TD><TD>&nbsp;</TD><TD>Density at port_b [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_a</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_a (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_b</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_b (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>length</TD><TD>&nbsp;</TD><TD>Length of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Diameter"
>Diameter</A></TD><TD>diameter</TD><TD>&nbsp;</TD><TD>Inner (hydraulic) diameter of pipe [m]</TD></TR>
<TR><TD>Real</TD><TD>g_times_height_ab</TD><TD>&nbsp;</TD><TD>Gravity times (Height(port_b) - Height(port_a))</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>roughness</TD><TD>2.5e-5</TD><TD>Absolute roughness of pipe, with a default for a smooth steel pipe (dummy if use_roughness = false) [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.AbsolutePressure"
>AbsolutePressure</A></TD><TD>dp_small</TD><TD>1</TD><TD>Turbulent flow if |dp| &gt;= dp_small (dummy if use_dp_small = false) [Pa]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow</TD><TD>Mass flow rate from port_a to port_b [kg/s]</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">redeclare </font><font color="blue">function</font> <font color="blue">extends </font>massFlowRate_dp_staticHead <font color="darkgreen">
  &quot;Return mass flow rate m_flow as function of pressure loss dp, i.e., m_flow = f(dp), due to wall friction and static head&quot;</font>


<font color="blue">protected </font>
  Real Delta = roughness/diameter <font color="darkgreen">&quot;Relative roughness&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re <font color="darkgreen">&quot;Reynolds number&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1 = (745*<font color="red">exp</font>(<font color="blue">if </font>Delta &lt;= 0.0065<font color="blue"> then </font>1<font color="blue"> else </font>0.0065/Delta))^0.97 <font color="darkgreen">
    &quot;Boundary between laminar regime and transition&quot;</font>;
  <font color="blue">constant </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2 = 4000 <font color="darkgreen">
    &quot;Boundary between transition and turbulent regime&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_a <font color="darkgreen">
    &quot;Upper end of regularization domain of the m_flow(dp) relation&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_b <font color="darkgreen">
    &quot;Lower end of regularization domain of the m_flow(dp) relation&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_a <font color="darkgreen">&quot;Value at upper end of regularization domain&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_b <font color="darkgreen">&quot;Value at lower end of regularization domain&quot;</font>;

  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> dm_flow_ddp_fric_a <font color="darkgreen">
    &quot;Derivative at upper end of regularization domain&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> dm_flow_ddp_fric_b <font color="darkgreen">
    &quot;Derivative at lower end of regularization domain&quot;</font>;

  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_grav_a = g_times_height_ab*rho_a <font color="darkgreen">
    &quot;Static head if mass flows in design direction (a to b)&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_grav_b = g_times_height_ab*rho_b <font color="darkgreen">
    &quot;Static head if mass flows against design direction (b to a)&quot;</font>;

  <font color="darkgreen">// Properly define zero mass flow conditions</font>
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_zero = 0;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_zero = (dp_grav_a + dp_grav_b)/2;
  Real dm_flow_ddp_fric_zero;

<font color="blue">algorithm </font>
  dp_a :=<font color="red"> max</font>(dp_grav_a, dp_grav_b)+dp_small;
  dp_b :=<font color="red"> min</font>(dp_grav_a, dp_grav_b)-dp_small;

  <font color="blue">if </font>dp&gt;=dp_a<font color="blue"> then</font>
    <font color="darkgreen">// Positive flow outside regularization</font>
    m_flow :=<font color="red"> Internal.m_flow_of_dp_fric</font>(dp-dp_grav_a, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
  <font color="blue">elseif </font>dp&lt;=dp_b<font color="blue"> then</font>
    <font color="darkgreen">// Negative flow outside regularization</font>
    m_flow :=<font color="red"> Internal.m_flow_of_dp_fric</font>(dp-dp_grav_b, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
  <font color="blue">else</font>
    <font color="darkgreen">// Regularization parameters</font>
    (m_flow_a, dm_flow_ddp_fric_a) :=<font color="red"> Internal.m_flow_of_dp_fric</font>(dp_a-dp_grav_a, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
    (m_flow_b, dm_flow_ddp_fric_b) :=<font color="red"> Internal.m_flow_of_dp_fric</font>(dp_b-dp_grav_b, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
    <font color="darkgreen">// Include a properly defined zero mass flow point</font>
    <font color="darkgreen">// Obtain a suitable slope from the linear section slope c (value of m_flow is overwritten later)</font>
    (m_flow, dm_flow_ddp_fric_zero) :=<font color="red"> Utilities.regFun3</font>(dp_zero, dp_b, dp_a, m_flow_b, m_flow_a, dm_flow_ddp_fric_b, dm_flow_ddp_fric_a);
    <font color="darkgreen">// Do regularization</font>
    <font color="blue">if </font>dp&gt;dp_zero<font color="blue"> then</font>
      m_flow :=<font color="red"> Utilities.regFun3</font>(dp, dp_zero, dp_a, m_flow_zero, m_flow_a, dm_flow_ddp_fric_zero, dm_flow_ddp_fric_a);
    <font color="blue">else</font>
      m_flow :=<font color="red"> Utilities.regFun3</font>(dp, dp_b, dp_zero, m_flow_b, m_flow_zero, dm_flow_ddp_fric_b, dm_flow_ddp_fric_zero);
    <font color="blue">end if</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>massFlowRate_dp_staticHead;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE pressureLoss_m_flow_staticHead<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.massFlowRate_dpI.png" ALT="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow_staticHead" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed.pressureLoss_m_flow_staticHead"></A><A HREF="Modelica_Fluid_Pipes_BaseClasses_WallFriction_Detailed.html#Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed"
>Modelica.Fluid.Pipes.BaseClasses.WallFriction.Detailed</A>.pressureLoss_m_flow_staticHead</H2>
<B>Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction and static head</B><p>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow</TD><TD>&nbsp;</TD><TD>Mass flow rate from port_a to port_b [kg/s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_a</TD><TD>&nbsp;</TD><TD>Density at port_a [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Density"
>Density</A></TD><TD>rho_b</TD><TD>&nbsp;</TD><TD>Density at port_b [kg/m3]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_a</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_a (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu_b</TD><TD>&nbsp;</TD><TD>Dynamic viscosity at port_b (dummy if use_mu = false) [Pa.s]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>length</TD><TD>&nbsp;</TD><TD>Length of pipe [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Diameter"
>Diameter</A></TD><TD>diameter</TD><TD>&nbsp;</TD><TD>Inner (hydraulic) diameter of pipe [m]</TD></TR>
<TR><TD>Real</TD><TD>g_times_height_ab</TD><TD>&nbsp;</TD><TD>Gravity times (Height(port_b) - Height(port_a))</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>roughness</TD><TD>2.5e-5</TD><TD>Absolute roughness of pipe, with a default for a smooth steel pipe (dummy if use_roughness = false) [m]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>m_flow_small</TD><TD>0.01</TD><TD>Turbulent flow if |m_flow| &gt;= m_flow_small (dummy if use_m_flow_small = false) [kg/s]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dp</TD><TD>Pressure loss (dp = port_a.p - port_b.p) [Pa]</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">redeclare </font><font color="blue">function</font> <font color="blue">extends </font>pressureLoss_m_flow_staticHead <font color="darkgreen">
  &quot;Return pressure loss dp as function of mass flow rate m_flow, i.e., dp = f(m_flow), due to wall friction and static head&quot;</font>


<font color="blue">protected </font>
  Real Delta = roughness/diameter <font color="darkgreen">&quot;Relative roughness&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re1 = 745*<font color="red">exp</font>(<font color="blue">if </font>Delta &lt;= 0.0065<font color="blue"> then </font>1<font color="blue"> else </font>0.0065/Delta) <font color="darkgreen">
    &quot;Boundary between laminar regime and transition&quot;</font>;
  <font color="blue">constant </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.ReynoldsNumber"
>SI.ReynoldsNumber</A> Re2 = 4000 <font color="darkgreen">
    &quot;Boundary between transition and turbulent regime&quot;</font>;

  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_a <font color="darkgreen">
    &quot;Upper end of regularization domain of the dp(m_flow) relation&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_b <font color="darkgreen">
    &quot;Lower end of regularization domain of the dp(m_flow) relation&quot;</font>;

  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_a <font color="darkgreen">&quot;Value at upper end of regularization domain&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_b <font color="darkgreen">&quot;Value at lower end of regularization domain&quot;</font>;

  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_grav_a = g_times_height_ab*rho_a <font color="darkgreen">
    &quot;Static head if mass flows in design direction (a to b)&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_grav_b = g_times_height_ab*rho_b <font color="darkgreen">
    &quot;Static head if mass flows against design direction (b to a)&quot;</font>;

  Real ddp_dm_flow_a <font color="darkgreen">
    &quot;Derivative of pressure drop with mass flow rate at m_flow_a&quot;</font>;
  Real ddp_dm_flow_b <font color="darkgreen">
    &quot;Derivative of pressure drop with mass flow rate at m_flow_b&quot;</font>;

  <font color="darkgreen">// Properly define zero mass flow conditions</font>
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> m_flow_zero = 0;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Pressure"
>SI.Pressure</A> dp_zero = (dp_grav_a + dp_grav_b)/2;
  Real ddp_dm_flow_zero;

<font color="blue">algorithm </font>
  m_flow_a := <font color="blue">if </font>dp_grav_a&lt;dp_grav_b<font color="blue"> then </font>
    <font color="red">Internal.m_flow_of_dp_fric</font>(dp_grav_b - dp_grav_a, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta)+m_flow_small<font color="blue"> else </font>
    m_flow_small;
  m_flow_b := <font color="blue">if </font>dp_grav_a&lt;dp_grav_b<font color="blue"> then </font>
    <font color="red">Internal.m_flow_of_dp_fric</font>(dp_grav_a - dp_grav_b, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta)-m_flow_small<font color="blue"> else </font>
    -m_flow_small;

  <font color="blue">if </font>m_flow&gt;=m_flow_a<font color="blue"> then</font>
    <font color="darkgreen">// Positive flow outside regularization</font>
    dp :=<font color="red"> Internal.dp_fric_of_m_flow</font>(m_flow, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta) + dp_grav_a;
  <font color="blue">elseif </font>m_flow&lt;=m_flow_b<font color="blue"> then</font>
    <font color="darkgreen">// Negative flow outside regularization</font>
    dp :=<font color="red"> Internal.dp_fric_of_m_flow</font>(m_flow, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta) + dp_grav_b;
  <font color="blue">else</font>
    <font color="darkgreen">// Regularization parameters</font>
    (dp_a, ddp_dm_flow_a) :=<font color="red"> Internal.dp_fric_of_m_flow</font>(m_flow_a, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
    dp_a := dp_a + dp_grav_a <font color="darkgreen">&quot;Adding dp_grav to dp_fric to get dp&quot;</font>;
    (dp_b, ddp_dm_flow_b) :=<font color="red"> Internal.dp_fric_of_m_flow</font>(m_flow_b, rho_a, rho_b, mu_a, mu_b, length, diameter, Re1, Re2, Delta);
    dp_b := dp_b + dp_grav_b <font color="darkgreen">&quot;Adding dp_grav to dp_fric to get dp&quot;</font>;
    <font color="darkgreen">// Include a properly defined zero mass flow point</font>
    <font color="darkgreen">// Obtain a suitable slope from the linear section slope c (value of dp is overwritten later)</font>
    (dp, ddp_dm_flow_zero) :=<font color="red"> Utilities.regFun3</font>(m_flow_zero, m_flow_b, m_flow_a, dp_b, dp_a, ddp_dm_flow_b, ddp_dm_flow_a);
    <font color="darkgreen">// Do regularization</font>
    <font color="blue">if </font>m_flow&gt;m_flow_zero<font color="blue"> then</font>
      dp :=<font color="red"> Utilities.regFun3</font>(m_flow, m_flow_zero, m_flow_a, dp_zero, dp_a, ddp_dm_flow_zero, ddp_dm_flow_a);
    <font color="blue">else</font>
      dp :=<font color="red"> Utilities.regFun3</font>(m_flow, m_flow_b, m_flow_zero, dp_b, dp_zero, ddp_dm_flow_b, ddp_dm_flow_zero);
    <font color="blue">end if</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>pressureLoss_m_flow_staticHead;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.Dymola.com/">Dymola</a> Mon Sep  7 10:20:10 2009.
</address></BODY>
</HTML>
