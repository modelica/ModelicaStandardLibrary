
<html>
<head>
  <meta charset="UTF-8">
  <link rel=stylesheet type=text/css href="resources/documentation.css">
  <script src="resources/jquery.min.js"></script>
  <script src="resources/scripts.js"></script>
</head>
<body>
<div class="wrapper">
<nav>
  <ul class="cf">
    <li><a href="https://www.wolfram.com/system-modeler/">SystemModeler</a></li>
  <li><a href="Modelica.html">Modelica</a></li>
  <li><a href="Modelica.Blocks.html">Blocks</a></li>
  <li><a href="Modelica.Blocks.Sources.html">Sources</a></li>
  <li><a href="Modelica.Blocks.Sources.CombiTimeTable.html">CombiTimeTable</a></li>
  </ul>
</nav>
<header>
  <table><tr><td>
    <h1>CombiTimeTable</h1>
    <p>Table look-up with respect to time and linear/periodic extrapolation methods (data from matrix/file)</p>
  </td><td>
    <div><img width="60" height="60" src="resources/icons/Modelica.Blocks.Sources.CombiTimeTable_60x60.png"></div>
  </td></tr></table>
</header>
<section id="information">
<h1>Information</h1>
<div class="hideable">
<p class="aside">This information is part of the Modelica Standard Library maintained by the Modelica Association.</p>
<p>
This block generates an output signal y[:] by <strong>constant</strong>,
<strong>linear</strong> or <strong>cubic Hermite spline interpolation</strong>
in a table. The time points and function values are stored in a matrix
<strong>table[i,j]</strong>, where the first column table[:,1] contains the
time points and the other columns contain the data to be interpolated.
</p>

<p>
<img src="resources/Modelica.Blocks.Sources.CombiTimeTable_info_001.png"
     alt="CombiTimeTable.png">
</p>

<p>
Via parameter <strong>columns</strong> it can be defined which columns of the
table are interpolated. If, e.g., columns={2,4}, it is assumed that
2 output signals are present and that the first output is computed
by interpolation of column 2 and the second output is computed
by interpolation of column 4 of the table matrix.
The table interpolation has the following properties:
</p>
<ul>
<li>The interpolation interval is found by a binary search where the interval used in the
    last call is used as start interval.</li>
<li>The time points need to be <strong>strictly increasing</strong> for cubic Hermite
    spline interpolation, otherwise <strong>monotonically increasing</strong>.</li>
<li><strong>Discontinuities</strong> are allowed for (constant or) linear interpolation,
    by providing the same time point twice in the table.</li>
<li>Via parameter <strong>smoothness</strong> it is defined how the data is interpolated:
<pre>
  smoothness = 1: Linear interpolation
             = 2: Akima interpolation: Smooth interpolation by cubic Hermite
                  splines such that der(y) is continuous, also if extrapolated.
             = 3: Constant segments
             = 4: Fritsch-Butland interpolation: Smooth interpolation by cubic
                  Hermite splines such that y preserves the monotonicity and
                  der(y) is continuous, also if extrapolated.
             = 5: Steffen interpolation: Smooth interpolation by cubic Hermite
                  splines such that y preserves the monotonicity and der(y)
                  is continuous, also if extrapolated.
</pre></li>
<li>Values <strong>outside</strong> of the table range, are computed by
    extrapolation according to the setting of parameter <strong>extrapolation</strong>:
<pre>
  extrapolation = 1: Hold the first or last value of the table,
                     if outside of the table scope.
                = 2: Extrapolate by using the derivative at the first/last table
                     points if outside of the table scope.
                     (If smoothness is LinearSegments or ConstantSegments
                     this means to extrapolate linearly through the first/last
                     two table points.).
                = 3: Periodically repeat the table data (periodical function).
                = 4: No extrapolation, i.e. extrapolation triggers an error
</pre></li>
<li>If the table has only <strong>one row</strong>, no interpolation is performed and
    the table values of this row are just returned.</li>
<li>Via parameters <strong>shiftTime</strong> and <strong>offset</strong> the curve defined
    by the table can be shifted both in time and in the ordinate value.
    The time instants stored in the table are therefore <strong>relative</strong>
    to <strong>shiftTime</strong>.</li>
<li>If time &lt; startTime, no interpolation is performed and the offset
    is used as ordinate value for all outputs.</li>
<li>The table is implemented in a numerically sound way by
    generating <strong>time events</strong> at interval boundaries, in case of
    interpolation by linear segments.
    This generates continuously differentiable values for the integrator.
    Via parameter <strong>timeEvents</strong> it is defined how the time events are generated:
<pre>
  timeEvents = 1: Always generate time events at interval boundaries
             = 2: Generate time events at discontinuities (defined by duplicated sample points)
             = 3: No time events at interval boundaries
</pre>
    For interpolation by constant segments time events are always generated at interval boundaries.
    For smooth interpolation by cubic Hermite splines no time events are generated at interval boundaries.</li>
<li>Via parameter <strong>timeScale</strong> the first column of the table array can
    be scaled, e.g., if the table array is given in hours (instead of seconds)
    <strong>timeScale</strong> shall be set to 3600.</li>
<li>For special applications it is sometimes needed to know the minimum
    and maximum time instant defined in the table as a parameter. For this
    reason parameters <strong>t_min</strong>/<strong>t_minScaled</strong> and
    <strong>t_max</strong>/<strong>t_maxScaled</strong> are provided and can be
    accessed from the outside of the table object. Whereas <strong>t_min</strong> and
    <strong>t_max</strong> define the scaled abscissa values (using parameter
    <strong>timeScale</strong>) in SIunits.Time, <strong>t_minScaled</strong> and
    <strong>t_maxScaled</strong> define the unitless original abscissa values of
    the table.</li>
</ul>
<p>
Example:
</p>
<pre>
   table = [0, 0;
            1, 0;
            1, 1;
            2, 4;
            3, 9;
            4, 16];
   extrapolation = 2 (default), timeEvents = 2
If, e.g., time = 1.0, the output y =  0.0 (before event), 1.0 (after event)
    e.g., time = 1.5, the output y =  2.5,
    e.g., time = 2.0, the output y =  4.0,
    e.g., time = 5.0, the output y = 23.0 (i.e., extrapolation via last 2 points).
</pre>
<p>
The table matrix can be defined in the following ways:
</p>
<ol>
<li>Explicitly supplied as <strong>parameter matrix</strong> "table",
    and the other parameters have the following values:
<pre>
   tableName is "NoName" or has only blanks,
   fileName  is "NoName" or has only blanks.
</pre></li>
<li><strong>Read</strong> from a <strong>file</strong> "fileName" where the matrix is stored as
    "tableName". Both text and MATLAB MAT-file format is possible.
    (The text format is described below).
    The MAT-file format comes in four different versions: v4, v6, v7 and v7.3.
    The library supports at least v4, v6 and v7 whereas v7.3 is optional.
    It is most convenient to generate the MAT-file from FreeMat or MATLAB&reg;
    by command
<pre>
   save tables.mat tab1 tab2 tab3
</pre>
    or Scilab by command
<pre>
   savematfile tables.mat tab1 tab2 tab3
</pre>
    when the three tables tab1, tab2, tab3 should be used from the model.<br>
    Note, a fileName can be defined as URI by using the helper function
    <a href="Modelica.Utilities.Files.loadResource.html">loadResource</a>.</li>
<li>Statically stored in function "usertab" in file "usertab.c".
    The matrix is identified by "tableName". Parameter
    fileName = "NoName" or has only blanks. Row-wise storage is always to be
    preferred as otherwise the table is reallocated and transposed.</li>
</ol>
<p>
When the constant "NO_FILE_SYSTEM" is defined, all file I/O related parts of the
source code are removed by the C-preprocessor, such that no access to files takes place.
</p>
<p>
If tables are read from a text file, the file needs to have the
following structure ("-----" is not part of the file content):
</p>
<pre>
-----------------------------------------------------
#1
double tab1(6,2)   # comment line
  0   0
  1   0
  1   1
  2   4
  3   9
  4  16
double tab2(6,2)   # another comment line
  0   0
  2   0
  2   2
  4   8
  6  18
  8  32
-----------------------------------------------------
</pre>
<p>
Note, that the first two characters in the file need to be
"#1" (a line comment defining the version number of the file format).
Afterwards, the corresponding matrix has to be declared
with type (= "double" or "float"), name and actual dimensions.
Finally, in successive rows of the file, the elements of the matrix
have to be given. The elements have to be provided as a sequence of
numbers in row-wise order (therefore a matrix row can span several
lines in the file and need not start at the beginning of a line).
Numbers have to be given according to C syntax (such as 2.3, -2, +2.e4).
Number separators are spaces, tab (\t), comma (,), or semicolon (;).
Several matrices may be defined one after another. Line comments start
with the hash symbol (#) and can appear everywhere.
Text files should either be ASCII or UTF-8 encoded, where UTF-8 encoded strings are only allowed in line comments and an optional UTF-8 BOM at the start of the text file is ignored.
Other characters, like trailing non comments, are not allowed in the file.
</p>
<p>
MATLAB is a registered trademark of The MathWorks, Inc.
</p>
</div>
</section>
<section id="parameters" >
  <h1>Parameters <span class="count">(19)</span></h1>
  <div class="hideable">
    <table class="shared-styles style-1">
    <colgroup><col class="col-1" /><col class="col-2" /></colgroup>
    <tbody>
    <tr>
      <th>nout</th>
      <td>
        <p><span>Value:</span> max([size(columns, 1); size(offset, 1)])</p>
        <p><span>Type:</span> Integer</p>
        <p><span>Description:</span> Number of outputs</p>
      </td>
    </tr>
    <tr>
      <th>tableOnFile</th>
      <td>
        <p><span>Value:</span> false</p>
        <p><span>Type:</span> Boolean</p>
        <p><span>Description:</span> = true, if table is defined on file or in function usertab</p>
      </td>
    </tr>
    <tr>
      <th>table</th>
      <td>
        <p><span>Value:</span> fill(0.0, 0, 2)</p>
        <p><span>Type:</span> Real[:,:]</p>
        <p><span>Description:</span> Table matrix (time = first column; e.g., table=[0, 0; 1, 1; 2, 4])</p>
      </td>
    </tr>
    <tr>
      <th>tableName</th>
      <td>
        <p><span>Value:</span> "NoName"</p>
        <p><span>Type:</span> String</p>
        <p><span>Description:</span> Table name on file or in function usertab (see docu)</p>
      </td>
    </tr>
    <tr>
      <th>fileName</th>
      <td>
        <p><span>Value:</span> "NoName"</p>
        <p><span>Type:</span> String</p>
        <p><span>Description:</span> File where matrix is stored</p>
      </td>
    </tr>
    <tr>
      <th>verboseRead</th>
      <td>
        <p><span>Value:</span> true</p>
        <p><span>Type:</span> Boolean</p>
        <p><span>Description:</span> = true, if info message that file is loading is to be printed</p>
      </td>
    </tr>
    <tr>
      <th>columns</th>
      <td>
        <p><span>Value:</span> 2:size(table, 2)</p>
        <p><span>Type:</span> Integer[:]</p>
        <p><span>Description:</span> Columns of table to be interpolated</p>
      </td>
    </tr>
    <tr>
      <th>smoothness</th>
      <td>
        <p><span>Value:</span> Modelica.Blocks.Types.Smoothness.LinearSegments</p>
        <p><span>Type:</span> <a href="Modelica.Blocks.Types.Smoothness.html">Smoothness</a></p>
        <p><span>Description:</span> Smoothness of table interpolation</p>
      </td>
    </tr>
    <tr>
      <th>extrapolation</th>
      <td>
        <p><span>Value:</span> Modelica.Blocks.Types.Extrapolation.LastTwoPoints</p>
        <p><span>Type:</span> <a href="Modelica.Blocks.Types.Extrapolation.html">Extrapolation</a></p>
        <p><span>Description:</span> Extrapolation of data outside the definition range</p>
      </td>
    </tr>
    <tr>
      <th>timeScale</th>
      <td>
        <p><span>Value:</span> 1</p>
        <p><span>Type:</span> <a href="Modelica.SIunits.Time.html">Time</a> (s)</p>
        <p><span>Description:</span> Time scale of first table column</p>
      </td>
    </tr>
    <tr>
      <th>offset</th>
      <td>
        <p><span>Value:</span> {0}</p>
        <p><span>Type:</span> Real[:]</p>
        <p><span>Description:</span> Offsets of output signals</p>
      </td>
    </tr>
    <tr>
      <th>startTime</th>
      <td>
        <p><span>Value:</span> 0</p>
        <p><span>Type:</span> <a href="Modelica.SIunits.Time.html">Time</a> (s)</p>
        <p><span>Description:</span> Output = offset for time < startTime</p>
      </td>
    </tr>
    <tr>
      <th>shiftTime</th>
      <td>
        <p><span>Value:</span> startTime</p>
        <p><span>Type:</span> <a href="Modelica.SIunits.Time.html">Time</a> (s)</p>
        <p><span>Description:</span> Shift time of first table column</p>
      </td>
    </tr>
    <tr>
      <th>timeEvents</th>
      <td>
        <p><span>Value:</span> Modelica.Blocks.Types.TimeEvents.Always</p>
        <p><span>Type:</span> <a href="Modelica.Blocks.Types.TimeEvents.html">TimeEvents</a></p>
        <p><span>Description:</span> Time event handling of table interpolation</p>
      </td>
    </tr>
    <tr>
      <th>verboseExtrapolation</th>
      <td>
        <p><span>Value:</span> false</p>
        <p><span>Type:</span> Boolean</p>
        <p><span>Description:</span> = true, if warning messages are to be printed if time is outside the table definition range</p>
      </td>
    </tr>
    <tr>
      <th>t_min</th>
      <td>
        <p><span>Value:</span> t_minScaled * timeScale</p>
        <p><span>Type:</span> <a href="Modelica.SIunits.Time.html">Time</a> (s)</p>
        <p><span>Description:</span> Minimum abscissa value defined in table</p>
      </td>
    </tr>
    <tr>
      <th>t_max</th>
      <td>
        <p><span>Value:</span> t_maxScaled * timeScale</p>
        <p><span>Type:</span> <a href="Modelica.SIunits.Time.html">Time</a> (s)</p>
        <p><span>Description:</span> Maximum abscissa value defined in table</p>
      </td>
    </tr>
    <tr>
      <th>t_minScaled</th>
      <td>
        <p><span>Value:</span> Internal.getTimeTableTmin(tableID)</p>
        <p><span>Type:</span> Real</p>
        <p><span>Description:</span> Minimum (scaled) abscissa value defined in table</p>
      </td>
    </tr>
    <tr>
      <th>t_maxScaled</th>
      <td>
        <p><span>Value:</span> Internal.getTimeTableTmax(tableID)</p>
        <p><span>Type:</span> Real</p>
        <p><span>Description:</span> Maximum (scaled) abscissa value defined in table</p>
      </td>
    </tr>
    </tbody>
    </table>
  </div>
</section>
<section id="connectors" class="closed">
  <h1>Connectors <span class="count">(1)</span></h1>
  <div class="hideable">
    <table class="shared-styles style-3">
    <colgroup><col class="col-1" /><col class="col-2" /><col class="col-3" /></colgroup>
    <tbody>
    <tr>
      <td><img width="16" height="16" src="resources/icons/Modelica.Blocks.Interfaces.RealOutput_16x16.png"></td>
      <th>y</th>
      <td>
        <p><span>Type:</span> <a href="Modelica.Blocks.Interfaces.RealOutput.html">RealOutput[nout]</a></p>
        <p><span>Description:</span> Connector of Real output signals</p>
      </td>
    </tr>
    </tbody>
    </table>
  </div>
</section>
<section id="components" class="closed">
  <h1>Components <span class="count">(1)</span></h1>
  <div class="hideable">
    <table class="shared-styles style-3">
    <colgroup><col class="col-1" /><col class="col-2" /><col class="col-3" /></colgroup>
    <tbody>
    <tr>
      <td></td>
      <th>tableID</th>
      <td>
        <p><span>Type:</span> <a href="Modelica.Blocks.Types.ExternalCombiTimeTable.html">ExternalCombiTimeTable</a></p>
        <p><span>Description:</span> External table object</p>
      </td>
    </tr>
    </tbody>
    </table>
  </div>
</section>
<section id="used-in-examples" class="closed">
  <h1>Used in Examples <span class="count">(9)</span></h1>
  <div class="hideable">
    <table class="shared-styles style-2">
    <colgroup><col class="col-1" /><col class="col-2" /></colgroup>
    <tbody>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Electrical.Machines.Examples.AsynchronousInductionMachines.AIMC_Conveyor_32x32.png"></td>
      <td>
        <p><a href="Modelica.Electrical.Machines.Examples.AsynchronousInductionMachines.AIMC_Conveyor.html">AIMC_Conveyor</a></p>
        <p><span>Modelica.Electrical.Machines.Examples.AsynchronousInductionMachines</span></p>
        <p>Test example: AsynchronousInductionMachineSquirrelCage with inverter driving a conveyor</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Magnetic.FluxTubes.Examples.SolenoidActuator.ComparisonPullInStroke_32x32.png"></td>
      <td>
        <p><a href="Modelica.Magnetic.FluxTubes.Examples.SolenoidActuator.ComparisonPullInStroke.html">ComparisonPullInStroke</a></p>
        <p><span>Modelica.Magnetic.FluxTubes.Examples.SolenoidActuator</span></p>
        <p>Pull-in stroke of both solenoid models after a voltage step at time t=0</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Magnetic.FundamentalWave.Examples.BasicMachines.AIMC_Conveyor_32x32.png"></td>
      <td>
        <p><a href="Modelica.Magnetic.FundamentalWave.Examples.BasicMachines.AIMC_Conveyor.html">AIMC_Conveyor</a></p>
        <p><span>Modelica.Magnetic.FundamentalWave.Examples.BasicMachines</span></p>
        <p>Asynchronous induction machine with squirrel cage and inverter driving a conveyor</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Magnetic.QuasiStatic.FundamentalWave.Examples.BasicMachines.InductionMachines.IMC_Conveyor_32x32.png"></td>
      <td>
        <p><a href="Modelica.Magnetic.QuasiStatic.FundamentalWave.Examples.BasicMachines.InductionMachines.IMC_Conveyor.html">IMC_Conveyor</a></p>
        <p><span>Modelica.Magnetic.QuasiStatic.FundamentalWave.Examples.BasicMachines.InductionMachines</span></p>
        <p>Induction machine with squirrel cage and inverter driving a conveyor</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Mechanics.MultiBody.Examples.Elementary.RollingWheelSetPulling_32x32.png"></td>
      <td>
        <p><a href="Modelica.Mechanics.MultiBody.Examples.Elementary.RollingWheelSetPulling.html">RollingWheelSetPulling</a></p>
        <p><span>Modelica.Mechanics.MultiBody.Examples.Elementary</span></p>
        <p>Rolling wheel set that is pulled by a force</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Fluid.Examples.TraceSubstances.RoomCO2WithControls_32x32.png"></td>
      <td>
        <p><a href="Modelica.Fluid.Examples.TraceSubstances.RoomCO2WithControls.html">RoomCO2WithControls</a></p>
        <p><span>Modelica.Fluid.Examples.TraceSubstances</span></p>
        <p>Demonstrates a room volume with CO2 controls</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Thermal.FluidHeatFlow.Examples.TestOpenTank_32x32.png"></td>
      <td>
        <p><a href="Modelica.Thermal.FluidHeatFlow.Examples.TestOpenTank.html">TestOpenTank</a></p>
        <p><span>Modelica.Thermal.FluidHeatFlow.Examples</span></p>
        <p>Test the OpenTank model</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Thermal.FluidHeatFlow.Examples.TestCylinder_32x32.png"></td>
      <td>
        <p><a href="Modelica.Thermal.FluidHeatFlow.Examples.TestCylinder.html">TestCylinder</a></p>
        <p><span>Modelica.Thermal.FluidHeatFlow.Examples</span></p>
        <p>Two cylinder system</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Thermal.HeatTransfer.Examples.Motor_32x32.png"></td>
      <td>
        <p><a href="Modelica.Thermal.HeatTransfer.Examples.Motor.html">Motor</a></p>
        <p><span>Modelica.Thermal.HeatTransfer.Examples</span></p>
        <p>Second order thermal model of a motor</p>
      </td>
    </tr>
    </tbody>
    </table>
  </div>
</section>
<section id="used-in-components" class="closed">
  <h1>Used in Components <span class="count">(2)</span></h1>
  <div class="hideable">
    <table class="shared-styles style-2">
    <colgroup><col class="col-1" /><col class="col-2" /></colgroup>
    <tbody>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Blocks.Sources.BooleanTable_32x32.png"></td>
      <td>
        <p><a href="Modelica.Blocks.Sources.BooleanTable.html">BooleanTable</a></p>
        <p><span>Modelica.Blocks.Sources</span></p>
        <p>Generate a Boolean output signal based on a vector of time instants</p>
      </td>
    </tr>
    <tr>
      <td><img width="32" height="32" src="resources/icons/Modelica.Blocks.Sources.IntegerTable_32x32.png"></td>
      <td>
        <p><a href="Modelica.Blocks.Sources.IntegerTable.html">IntegerTable</a></p>
        <p><span>Modelica.Blocks.Sources</span></p>
        <p>Generate an Integer output signal based on a table matrix with [time, yi] values</p>
      </td>
    </tr>
    </tbody>
    </table>
  </div>
</section>
</div>
</body>
</html>